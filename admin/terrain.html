<!-- terrain.html
     Summary: Admin page for managing terrain presets with a direct 3D terrain editor that allows
              clicking on the surface to sculpt ground types and elevation. Includes a Perlin-noise
              generator for quickly creating natural-looking landscapes. The 3D view renders
              automatically whenever a map is created or its size/type is changed.
     Structure: login, navbar with profile menu, sidebar navigation, table of maps with thumbnails
               and an expandable 3D editor featuring camera controls and shading.
     Usage: Visit /admin/terrain.html after logging in to manage terrains and design custom maps. -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manage Terrain</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="admin.css">
</head>
<body>
  <nav id="navbar">
    <span>Admin Panel</span>
    <div class="profile-menu" id="profileMenu">
      <img src="https://placehold.co/32" alt="profile" id="profilePic" />
      <div class="profile-menu-content" id="profileMenuContent">
        <a href="#">Manage Profiles</a>
        <a href="#">Learning Zone</a>
        <a href="#">My Details</a>
        <a href="#">Subscription Details</a>
        <a href="#">Manage Users</a>
        <a href="#" id="signOutLink">Sign out</a>
      </div>
    </div>
  </nav>

  <div id="login">
    <h2>Admin Login</h2>
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Login</button>
  </div>

  <div id="app" style="display:none">
    <aside id="sidebar">
      <a href="admin.html">Dashboard</a>
      <a href="nations.html">Nations</a>
      <a href="tanks.html">Tanks</a>
      <a href="ammo.html">Ammo</a>
      <a href="terrain.html">Terrain</a>
      <a href="settings.html">Game Settings</a>
    </aside>
    <main id="mainContent">
      <section class="card">
        <h2>Terrain</h2>
        <p class="instructions">Manage saved maps. Click Add to create a new map or Edit to modify.</p>
        <button id="newTerrainBtn">Add Map</button>
        <table id="terrainTable">
          <thead>
            <tr><th>Preview</th><th>Type</th><th>Size (km)</th><th>Name</th><th>Actions</th></tr>
          </thead>
          <tbody id="terrainList"></tbody>
        </table>
        <button id="restartBtn">Restart Game</button>
      </section>

      <section class="card" id="editorCard" style="display:none">
        <h2>Terrain Editor</h2>

        <div id="editorControls">
          <p class="instructions">Map preview updates automatically when size or terrain type changes.</p>
          <label for="terrainName">Name</label>
          <input id="terrainName" placeholder="Name">
          <label for="terrainType">Terrain Type</label>
          <select id="terrainType">
            <option value="snow">Snow</option>
            <option value="jungle">Jungle</option>
            <option value="desert">Desert</option>
            <option value="fields">Fields</option>
          </select>
          <label for="sizeX">Map width (km)</label>
          <input type="number" id="sizeX" min="0.1" step="0.1" value="1">
          <label for="sizeY">Map height (km)</label>
          <input type="number" id="sizeY" min="0.1" step="0.1" value="1">

          <label for="mode">Edit Mode</label>
          <select id="mode">
            <option value="ground">Ground</option>
            <option value="elevation">Elevation</option>
            <option value="flag">Capture Flags</option>
          </select>
          <label for="brushSizeX">Brush Size X (cells)</label>
          <input type="range" id="brushSizeX" min="1" max="10" value="2">
          <label for="brushSizeY">Brush Size Y (cells)</label>
          <input type="range" id="brushSizeY" min="1" max="10" value="2">
          <label for="brushSizeZ">Brush Height</label>
          <input type="range" id="brushSizeZ" min="1" max="20" value="5">
          <button id="perlinBtn">Generate Perlin Terrain</button>

          <div id="flagControls" style="display:none">
            <h3>Capture Flags</h3>
            <label for="flagTeam">Team</label>
            <select id="flagTeam">
              <option value="red">Red</option>
              <option value="blue">Blue</option>
            </select>
            <label for="flagPoint">Point</label>
            <select id="flagPoint">
              <option value="a">A</option>
              <option value="b">B</option>
              <option value="c">C</option>
              <option value="d">D</option>
            </select>
            <button id="clearFlagBtn">Clear Selected</button>
            <div id="flagPositions" class="flag-positions"></div>
          </div>

          <label for="showAxes">Show Axes</label>
          <input type="checkbox" id="showAxes" checked>

          <label for="viewSelect">View</label>
          <select id="viewSelect">
            <option value="iso">Isometric</option>
            <option value="top">Top</option>
            <option value="front">Front</option>
            <option value="side">Side</option>
          </select>
          <label for="projectionType">Projection</label>
          <select id="projectionType">
            <option value="perspective">Perspective</option>
            <option value="orthographic">Orthographic</option>
          </select>
          <label for="lockCamera">Lock Position</label>
          <input type="checkbox" id="lockCamera">

          <h3>Ground Types</h3>
          <div id="groundTypesList" class="ground-types"></div>
          <label for="groundName">Name</label>
          <input id="groundName" placeholder="e.g. gravel">
          <label for="groundColor">Color</label>
          <input id="groundColor" type="color" value="#777777">
          <label for="groundTraction">Traction (0-1)</label>
          <input id="groundTraction" type="number" step="0.1" min="0" max="1" value="0.5">
          <label for="groundViscosity">Viscosity (0-1)</label>
          <input id="groundViscosity" type="number" step="0.1" min="0" max="1" value="0.5">
          <button id="addGroundBtn">Add Ground Type</button>
          <button id="saveTerrainBtn">Save Map</button>
          <button id="cancelEditBtn">Cancel</button>
        </div>
        <div id="editorViews">
          <div id="terrain3d"></div>
        </div>
      </section>
    </main>
  </div>

  <script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>
  <script type="module" src="admin.js"></script>
  <script type="module" src="terrain-editor.js"></script>
</body>
</html>
